static void _aes_testEcb64(
    const void *key128,
    const void *key256,
    const void *message,
    const void *expected128,
    const void *expected256
) {
    uint8_t out[64];
    for (int32_t i = 0; i < 64; i += 16) aes128_block(&out[i], &message[i], key128);
    CHECK(mem_compare(&out[0], expected128, 64), RES == 0);

    for (int32_t i = 0; i < 64; i += 16) aes256_block(&out[i], &message[i], key256);
    CHECK(mem_compare(&out[0], expected256, 64), RES == 0);
}

static void aes_tests(void) {
    // Test vectors from FIPS 197.
    _aes_testEcb64(
        "\x2B\x7E\x15\x16\x28\xAE\xD2\xA6\xAB\xF7\x15\x88\x09\xCF\x4F\x3C",
        "\x60\x3D\xEB\x10\x15\xCA\x71\xBE\x2B\x73\xAE\xF0\x85\x7D\x77\x81\x1F\x35\x2C\x07\x3B\x61\x08\xD7\x2D\x98\x10\xA3\x09\x14\xDF\xF4",
        "\x6B\xC1\xBE\xE2\x2E\x40\x9F\x96\xE9\x3D\x7E\x11\x73\x93\x17\x2A\xAE\x2D\x8A\x57\x1E\x03\xAC\x9C\x9E\xB7\x6F\xAC\x45\xAF\x8E\x51\x30\xC8\x1C\x46\xA3\x5C\xE4\x11\xE5\xFB\xC1\x19\x1A\x0A\x52\xEF\xF6\x9F\x24\x45\xDF\x4F\x9B\x17\xAD\x2B\x41\x7B\xE6\x6C\x37\x10",
        "\x3A\xD7\x7B\xB4\x0D\x7A\x36\x60\xA8\x9E\xCA\xF3\x24\x66\xEF\x97\xF5\xD3\xD5\x85\x03\xB9\x69\x9D\xE7\x85\x89\x5A\x96\xFD\xBA\xAF\x43\xB1\xCD\x7F\x59\x8E\xCE\x23\x88\x1B\x00\xE3\xED\x03\x06\x88\x7B\x0C\x78\x5E\x27\xE8\xAD\x3F\x82\x23\x20\x71\x04\x72\x5D\xD4",
        "\xF3\xEE\xD1\xBD\xB5\xD2\xA0\x3C\x06\x4B\x5A\x7E\x3D\xB1\x81\xF8\x59\x1C\xCB\x10\xD4\x10\xED\x26\xDC\x5B\xA7\x4A\x31\x36\x28\x70\xB6\xED\x21\xB9\x9C\xA6\xF4\xF9\xF1\x53\xE7\xB1\xBE\xAF\xED\x1D\x23\x30\x4B\x7A\x39\xF9\xF3\xFF\x06\x7D\x8D\x8F\x9E\x24\xEC\xC7"
    );
}
